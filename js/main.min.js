/* following header for cardninal spline creating*/
/*!	Curve extension for canvas 2.3.6
 *	(c) Epistemex 2013-2016
 *	www.epistemex.com
 *	License: MIT
 */
function createLine(a,b,c,d,e){"use strict";function s(a,b,c,e){for(var g,f=2;f<c;f+=2){var s,t,u,v,h=a[f],j=a[f+1],l=a[f+2],m=a[f+3],n=(l-a[f-2])*e,o=(m-a[f-1])*e,p=(a[f+4]-h)*e,q=(a[f+5]-j)*e,r=0;for(g=0;g<d;g++)s=b[r++],t=b[r++],u=b[r++],v=b[r++],k[i++]=s*h+t*l+u*n+v*p,k[i++]=s*j+t*m+u*o+v*q}}c="number"==typeof c?c:.5,d="number"==typeof d?d:25;var f,g=1,h=b.length,i=0,j=(h-2)*d+2+(e?2*d:0),k=new Float32Array(j),l=new Float32Array(4*(d+2)),m=4;for(f=b.slice(0),e?(f.unshift(b[h-1]),f.unshift(b[h-2]),f.push(b[0],b[1])):(f.unshift(b[1]),f.unshift(b[0]),f.push(b[h-2],b[h-1])),l[0]=1;g<d;g++){var n=g/d,o=n*n,p=o*n,q=2*p,r=3*o;l[m++]=q-r+1,l[m++]=r-q,l[m++]=p-2*o+n,l[m++]=p-o}l[++m]=1,s(f,l,h,c),e&&(f=[],f.push(b[h-4],b[h-3],b[h-2],b[h-1],b[0],b[1],b[2],b[3]),s(f,l,4,c)),h=e?0:b.length-2,k[i++]=b[h++],k[i]=b[h];var t="M"+k[0]+" "+k[1]+" ";for(g=0,h=k.length;g<h;g+=2)g>=2&&(t+="L"+k[g]+" "+k[g+1]+" ");if(!a){var u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttributeNS(null,"id","mySVG"),u.setAttributeNS(null,"preserveAspectRatio","none"),u.setAttributeNS(null,"width","100%"),u.setAttributeNS(null,"height","300"),u.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),document.getElementById("svgHolder").appendChild(u);var v="http://www.w3.org/2000/svg",w=document.createElementNS(v,"path");w.setAttributeNS(null,"id","myLine"),w.setAttributeNS(null,"d",t),w.setAttributeNS(null,"stroke","black"),w.setAttributeNS(null,"stroke-width",3),w.setAttributeNS(null,"opacity",1),w.setAttributeNS(null,"fill","none"),document.getElementById("mySVG").appendChild(w)}if(a){var w=document.getElementById("myLine");w.setAttributeNS(null,"d",t)}return k}function Point(a,b){this.x=a,this.y=b}function drawTemps(a){for(i=0;i<a.length-2;i+=2)addTemp(a[i],a[i+1])}function redrawTemps(a){for(tempIndex=0,i=0;i<a.length-2;i+=2)updateTemp(a[i],a[i+1])}function createPoints(){points=[];var a=query(".day"),b=[].slice.call(a);b.forEach(function(a,b){var c=middle-a.getAttribute("data-high")*tempMultiplier,d=middle-a.getAttribute("data-low")*tempMultiplier,e=Math.round((b-.75)*(width/5)),f=Math.round((b-.25)*(width/5));points.push(e,c),points.push(f,d)})}function addTemp(a,b){var c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"text");d.setAttributeNS(null,"font-size","30"),d.setAttributeNS(null,"id","temp"+tempIndex),d.setAttributeNS(null,"font-family","Arial"),tempIndex++;var e=(middle-b)/tempMultiplier;if(e>=100)var f=30;else var f=15;d.setAttributeNS(null,"x",a-f),e>140?d.setAttributeNS(null,"y",0):e>115?d.setAttributeNS(null,"y",b+40):e<-20?d.setAttributeNS(null,"y",290):d.setAttributeNS(null,"y",b-15);var g=document.createTextNode(e+"°");d.appendChild(g),document.getElementById("mySVG").appendChild(d)}function updateTemp(a,b){var c=document.getElementById("temp"+tempIndex),d=(middle-b)/tempMultiplier;if(c.textContent=d+"°",tempIndex++,d>=100)var e=30;else var e=15;c.setAttributeNS(null,"x",a-e),d>140?c.setAttributeNS(null,"y",0):d>115?c.setAttributeNS(null,"y",b+40):d<-20?c.setAttributeNS(null,"y",290):c.setAttributeNS(null,"y",b-15)}function setWidth(){width=window.innerWidth}function getLocation(){navigator.geolocation?(navigator.geolocation.getCurrentPosition(showPosition,showError,{maximumAge:6e5,timeout:7e3}),success=1):(console.log("Geolocation is not supported by this browser."),success=0)}function showPosition(a,b){b?(latitude=a.latitude,longitude=a.longitude):(latitude=a.coords.latitude,longitude=a.coords.longitude),ajaxify(latitude,longitude,"")}function showError(a){switch(a.code){case a.PERMISSION_DENIED:console.log("User denied the request for Geolocation.");break;case a.POSITION_UNAVAILABLE:console.log("Location information is unavailable.");break;case a.TIMEOUT:console.log("The request to get user location timed out.");break;case a.UNKNOWN_ERROR:console.log("An unknown error occurred.")}success=1}function ajaxify(a,b,c){if(success){var d=new XMLHttpRequest;d.open("POST","getWeather.php",!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var a=JSON.parse(d.responseText);inputData(a),query("#location")[0].value="",query("#location")[0].blur(),query(".sk-cube-grid")[0].style.display="none",query(".weekly")[0].setAttribute("class","weekly"),attachSubmitHandler()}};var e="lat="+a+"&long="+b+"&location="+c;d.send(e)}}function attachSubmitHandler(){document.forms.locationSubmit.onsubmit=function(a){a.preventDefault();var b=query("#location")[0].value;inputValSAfe=b.replace(/ /g,"+");var c=new XMLHttpRequest;c.open("GET","https://maps.googleapis.com/maps/api/geocode/json?address="+inputValSAfe+"&key="+google_api_key,!0),c.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var a=JSON.parse(this.responseText);console.log();var e=(a.results[0].address_components,a.results[0].formatted_address.replace(", USA",""));newLat=a.results[0].geometry.location.lat,newLong=a.results[0].geometry.location.lng,ajaxify(newLat,newLong,e),query(".sk-cube-grid")[0].style.display="block",query(".weekly")[0].setAttribute("class","weekly sendingAjax")}},c.send(),c=null}}function normalizeTemps(a){var b="";for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];b+='<div class="hourly__item">'+d.niceTime+" <br> "+d.hourlyForecast+"</div>"}return b}function inputData(a){query(".locationName")[0].textContent=a.right_now.locationName,query("#todayWrapper .tempNow")[0].textContent=a.right_now.tempNow+"°";var b=query("#todayWrapper .iconNow span");b.length&&b[0].parentNode.removeChild(b[0]);var c=query("#todayWrapper .iconNow"),d=document.createElement("span");d.setAttribute("class","weatherIcon icon-"+a.right_now.tempNowIcon),c[0].appendChild(d),query("#todayWrapper .todaySummary")[0].textContent=a.right_now.tempNowSummary,query("#todayWrapper .laterToday")[0].textContent="Later Today: "+a.today.summary,query(".weekly .day.today")[0].setAttribute("data-high",a.today.max),query(".weekly .day.today")[0].setAttribute("data-low",a.today.min),query(".weekly .day.extraday")[0].setAttribute("data-high",a.extra_day.max),query(".weekly .day.extraday")[0].setAttribute("data-low",a.extra_day.min);var e=query(".weekly .day:not(.hidden)"),f=[].slice.call(e);f.forEach(function(b,c){b.setAttribute("data-high",a.this_week[+c+1].max),b.setAttribute("data-low",a.this_week[+c+1].min);var d=b.querySelectorAll('span[class^="icon-"]');d.length&&d[0].parentNode.removeChild(d[0]);var e=document.createElement("span");e.setAttribute("class","icon-"+a.this_week[+c+1].icon),b.insertBefore(e,b.firstChild),b.querySelector(".dayOfWeek").textContent=a.this_week[+c+1].day,b.querySelector(".max").textContent="Max: "+a.this_week[+c+1].max+"°",b.querySelector(".min").textContent="Min: "+a.this_week[+c+1].min+"°",b.querySelector(".summary").textContent=a.this_week[+c+1].summary}),setWidth(),createPoints(),init?(createLine(1,points.slice(2,points.length-2)),redrawTemps(points.slice(4,points.length-2))):(createLine(0,points.slice(2,points.length-2)),drawTemps(points.slice(4,points.length-2)))}window.query=document.querySelectorAll.bind(document),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(null===this)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=0;d<f;){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}});var points=[],width,height,middle=270,height=300,tempMultiplier=2,tempIndex=0,success,latitude,longitude,init=!1,google_api_key="AIzaSyDZoh4yZUjJFqVPlPBahd81lzOAooQRk8s";getLocation(),document.addEventListener("DOMContentLoaded",function(a){attachSubmitHandler()}),window.addEventListener("resize",function(){setWidth(),width>=1e3&&init&&(createPoints(),createLine(1,points.slice(2,points.length-2)),redrawTemps(points.slice(4,points.length-2)))});